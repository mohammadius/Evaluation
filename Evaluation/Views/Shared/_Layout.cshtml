@using Evaluation.Data
@using MD.PersianDateTime.Standard
@using Evaluation.Utilities

<!DOCTYPE html>
<html dir="rtl" lang="fa">
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="description" content="">
	<meta name="author" content="">

	<title>Evaluation</title>
	<link href="~/favicon.ico" rel="shortcut icon" type="image/x-icon" />

	<script type="text/javascript" src="~/js/vendor.js" asp-append-version="true"></script>

	<link rel="stylesheet" href="~/css/vendor.css" asp-append-version="true" />

	<link rel="stylesheet" href="~/css/devextreme/dx.common.css" />
	<link rel="stylesheet" href="~/css/devextreme/dx.light.css" />

	<link rel="stylesheet" href="~/css/Site.css" />
	@await RenderSectionAsync("Style", false)

</head>

<body class="dx-theme-background-color">
	@if (User.Identity.IsAuthenticated)
	{
		<div class="info">
			<div>@User.FindFirst(MyClaimTypes.DisplayRole).Value، خوش آمدید</div>
			<div>امروز @PersianDateTime.Now.ToLongDateString()</div>
		</div>
	}
	<header class="header">
		<div class="header-image-container">
			<a href="/" title="">
				<img class="header-image" src="~/images/Logo.png" alt="" />
			</a>
		</div>
		<h1 class="header-title text-center mx-auto">سامانه ارزیابی</h1>
		<div class="header-image-container">
			<a href="/" title="">
				<img class="header-image" src="~/images/Logo.png" alt="" />
			</a>
		</div>
	</header>
	<nav class="navigation">
		@if (User.Identity.IsAuthenticated)
		{
			<ul class="nav-list">
				<li class="nav-list-item">
					<a href="#">گزینه 1</a>
				</li>
				<li class="nav-list-item">
					<a href="#">گزینه 2</a>
				</li>
				<li class="nav-list-item">
					<a href="#">گزینه 3</a>
				</li>
			</ul>
			<a asp-controller="Home" asp-action="LogOut" class="logout">خروج</a>
		}
	</nav>

	<main role="main">
		<div class="row">
			<div class="col-md-3 mb-4 text-align-start">
				<div class="shadow py-2 bg-white rounded">
					@{
						var path = Context.Request.Path.Value.Split('/', StringSplitOptions.RemoveEmptyEntries)[0].ToLower();
						var accordionIndex = path switch
						{
							"information" => 0,
							"question" => 1,
							"user" => 2,
							"report" => 4,
							_ => 0
						};
					}
					@(Html.DevExtreme().Accordion()
				.RtlEnabled(true)
				.AnimationDuration(200)
				.ActiveStateEnabled(false)
				.FocusStateEnabled(false)
				.SelectedIndex(accordionIndex)
				.Items(items =>
				{
					items.Add()
						.Title("اطلاعات پایه")
						.Template(@<text>
							          @(Html.DevExtreme().List()
								          .Height("100%")
								          .DataSource(OptionsData.AdminOptions["BasicInformation"])
								          .ItemTemplate("<a href=\"<%- Href %>\"><%- DisplayName %></a>")
								          )
						           </text>);
					items.Add()
						.Title("تنظیمات حساب کاربری")
						.Template(@<text>
							          @(Html.DevExtreme().List()
								          .Height("100%")
								          .DataSource(OptionsData.AdminOptions["UserSetting"])
								          .ItemTemplate("<a href=\"<%- Href %>\"><%- DisplayName %></a>")
								          )
						           </text>);
					items.Add()
						.Title("گزارشات")
						.Template(@<text>
							          @(Html.DevExtreme().List()
								          .Height("100%")
								          .DataSource(OptionsData.AdminOptions["Report"])
								          .ItemTemplate("<a href=\"<%- Href %>\"><%- DisplayName %></a>")
								          )
						           </text>);
				})
				)
				</div>
			</div>
			<div class="col-md-9">
				<div class="main-container shadow p-4 bg-white rounded">
					@RenderBody()
				</div>
			</div>
		</div>
	</main>

	@{
		var errorMessage = ViewBag.ErrorMessage as string;
		var hasError = !string.IsNullOrWhiteSpace(errorMessage);

		if (hasError)
		{
			@(Html.DevExtreme().Toast()
				.Message(errorMessage)
				.Type(ToastType.Error)
				.DisplayTime(5000)
				.RtlEnabled(true)
				.CloseOnClick(true)
				.CloseOnSwipe(true)
				.Width("auto")
				.Position(p =>
				{
					p.At(HorizontalAlignment.Right, VerticalAlignment.Bottom);
					p.My(HorizontalAlignment.Right, VerticalAlignment.Bottom);
					p.Offset(-40, -40);
				})
				.Visible(true)
				)
		}
	}

	<footer class="footer">
		© &nbsp; کلیه حقوق مادی و معنوی این سامانه متعلق به دانشگاه علوم پزشکی جندی شاپور اهواز می&zwnj;باشد .
	</footer>
	@await RenderSectionAsync("Script", false)
</body>
</html>